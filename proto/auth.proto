syntax = "proto3";

package auth;

// Authentication service for user registration and login
service AuthService {
  rpc Register (RegisterRequest) returns (RegisterResponse) {}
  rpc Login (LoginRequest) returns (LoginResponse) {}
  rpc ValidateToken (ValidateTokenRequest) returns (ValidateTokenResponse) {}
  rpc RefreshToken (RefreshTokenRequest) returns (RefreshTokenResponse) {}
  rpc Authenticate (AuthenticateRequest) returns (AuthenticateResponse) {}
  rpc RevokeToken (RevokeTokenRequest) returns (RevokeTokenResponse) {}
  rpc Health (HealthRequest) returns (HealthResponse) {}
}

message HealthRequest {}

message HealthResponse {
  string message = 1;
}

// User registration
message RegisterRequest {
  string username = 1;
  string email = 2;
  string password = 3;
  string firstName = 4;
  string lastName = 5;
}

message RegisterResponse {
  string userId = 1;
  string message = 2;
  bool success = 3;
  repeated string errors = 4;
}

// User login
message LoginRequest {
  string username = 1;
  string password = 2;
}

message LoginResponse {
  string accessToken = 1;
  string refreshToken = 2;
  string message = 3;
  bool success = 4;
  repeated string errors = 6;
}

// Token validation
message ValidateTokenRequest {
  string token = 1;
}

message ValidateTokenResponse {
  bool isValid = 1;
  string userId = 2;
  string message = 3;
  repeated string errors = 4;
}

// Token refresh
message RefreshTokenRequest {
  string refreshToken = 1;
}

message RefreshTokenResponse {
  string accessToken = 1;
  string refreshToken = 2;
  string message = 3;
  bool success = 4;
  repeated string errors = 5;
}

// Authentication
message AuthenticateRequest {
  string token = 1;
}

message AuthenticateResponse {
  bool authenticated = 1;
  string userId = 2;
  string message = 3;
  repeated string errors = 4;
}

// Token revocation
message RevokeTokenRequest {
  string token = 1;
}

message RevokeTokenResponse {
  bool revoked = 1;
  string message = 2;
  repeated string errors = 3;
}

// Common response wrapper for consistency
message BaseResponse {
  bool success = 1;
  string message = 2;
  repeated string errors = 3;
}